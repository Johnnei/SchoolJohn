var resizeHandlers=[]
function resizeHandler(takeover){if(!is.handheld){var page=getById('page');if(page){if(!resizeHandler.initialized){resizeHandler.initialized=true;addEvent(window,'resize',resizeHandler);if(takeover&&window.prepareTopBanner)if((!screen.height||screen.height>=800)&&(!is.ie||is.ieVersion>=7)){prepareTopBanner('maybe');addClass(page.parentNode,'takeover')}};var pageDim=getPageDimensions(),currentClassName=page.className;switch(currentClassName){case'notracker':page.style.width=pageDim.availWidth<966?'auto':'966px';break;case'trackerright':page.style.width=pageDim.availWidth<1109?'882px':pageDim.availWidth<1193?'auto':'966px';break;default:page.style.width=pageDim.availWidth<1208?'auto':'1208px';if(currentClassName!='trackerfixed'){var className='';if(pageDim.availWidth<1064){className='res1024'}else if(pageDim.availWidth<1114){className='res1100'}else if(pageDim.availWidth<1138)className='res1152';if(className!=currentClassName)page.className=className}};if(window.resizeHandlers.length)window.resizeHandlers.forEach(function(handler){handler()})}}}
function addResizeHandler(func){if(typeof func=='string')func=window[func];if(func&&typeof func=='function'){var f=arguments.length>1?func.bind.apply(func,[window].concat(Array.slice(arguments,1))):func;window.resizeHandlers.push(f);f()}}
function SiteMenu(activeMenu){this.element=getById('siteMenu');this.menuItems=[];this.activeMenu=activeMenu;this.menuActive=false;this.menuItemTimeout=null;this.menuTimeout=null;this.init();SiteMenu.instance=this};Object.extend(SiteMenu.prototype,{init:function(){if(this.element){var menuItems=this.element.getElementsByTagName('li'),menuItem,i=0;while((menuItem=menuItems[++i])){addEvent(menuItem,'click',this.onClick.bind(this,i));addEvent(menuItem,'mouseover',this.onMouseover.bind(this,i));menuItem.subMenu=new SubMenu(i,menuItem.offsetLeft);this.menuItems[i]=menuItem};var header=getById('header');if(header){addEvent(header,'mouseover',this.cancelMouseout.bind(this));addEvent(header,'mouseout',this.onMouseout.bind(this,this.activeMenu));addEvent(window,'pageshow',this.reset.bind(this,this.activeMenu))};addCleanupHandler(this,['element','menuItems','menuActive'])}},positionSubMenus:function(){var i=0,menuItem;while((menuItem=this.menuItems[++i]))if(menuItem.subMenu.element)menuItem.subMenu.position()},onClick:function(i){clearTimeout(this.menuItemTimeout);this.menuActive=true;this.handleMouseover(i)},onMouseover:function(i,e){clearTimeout(this.menuItemTimeout);if(i!=this.activeMenu){var timeOut=250;if(this.menuActive){timeOut=100;if(e){var target=e.target||e.srcElement;if(target.nodeType==3)target=target.parentNode;if(target.nodeName=='A')timeOut=50}};this.menuItemTimeout=setTimeout(this.onClick.bind(this,i),timeOut)}},onMouseout:function(i){clearTimeout(this.menuTimeout);clearTimeout(this.menuItemTimeout);this.menuTimeout=setTimeout(this.handleMouseout.bind(this,i),5e3)},cancelMouseout:function(){clearTimeout(this.menuTimeout)},handleMouseover:function(i){if(this.menuActive&&this.menuItems&&i!=this.activeMenu){this.hideSubMenu();this.showSubMenu(i)}},handleMouseout:function(i){this.handleMouseover(i);this.menuActive=false},reset:function(i,e){if(e&&e.persisted&&this.menuItems){this.hideSubMenu();this.showSubMenu(i)}},showSubMenu:function(i){this.activeMenu=i;var menu=this.menuItems[i];if(menu){addClass(menu,'active');if(menu.subMenu.element)addClass(menu.subMenu.element,'active');if((menu=this.menuItems[i+1]))addClass(menu,'activeNeighbor')}},hideSubMenu:function(){var i=this.activeMenu,menu=this.menuItems[i];if(menu){removeClass(menu,'active');if(menu.subMenu.element){menu.subMenu.handleMouseout();removeClass(menu.subMenu.element,'active')};if((menu=this.menuItems[i+1]))removeClass(menu,'activeNeighbor')}}})
function SubMenu(id,offset){this.element=getById('groupNav'+id);this.menu=null;this.offset=offset;this.width=0;this.menuItems=[];this.activeMenu=-1;this.menuActive=false;this.menuTimeout=null;this.menuItemTimeout=null;this.init()};Object.extend(SubMenu.prototype,{init:function(){if(this.element){var lastitem,menuitem,menusubitem,i=0;if((this.menu=first_child(this.element,'ul'))){menuitem=first_child(this.menu,'li');if(menuitem){do{lastitem=menuitem;if((menusubitem=first_child(menuitem,'div'))){menuitem.className+='subitems';addEvent(menuitem,'click',this.onClick.bind(this,i));addEvent(menuitem,'mouseover',this.onMouseover.bind(this,i));this.menuItems[i++]=menusubitem}else addEvent(menuitem,'mouseover',this.handleMouseover.bind(this,-1))}while((menuitem=node_after(menuitem,'li')));this.width=lastitem.offsetLeft;this.position()}};addEvent(this.element,'mouseover',this.cancelMouseout.bind(this));addEvent(this.element,'mouseout',this.onMouseout.bind(this));menuitem=null,menusubitem=null;addCleanupHandler(this,['element','menu','menuItems','menuActive'])}},position:function(){if(this.width){var maxLeft=this.element.parentNode.offsetWidth-10,searchbox=getById('searchbox');if(searchbox)maxLeft=searchbox.offsetLeft-10;var offset=this.offset-Math.floor(this.width/2);offset+=65;if(offset+this.width>maxLeft)offset=maxLeft-this.width;if(offset<0)offset=0;this.element.style.left=offset+'px'}},onClick:function(i){clearTimeout(this.menuItemTimeout);this.menuActive=true;this.handleMouseover(i)},onMouseover:function(i){clearTimeout(this.menuItemTimeout);if(this.menuActive){this.handleMouseover(i)}else if(i!=this.activeMenu)this.menuItemTimeout=setTimeout(this.onClick.bind(this,i),50)},onMouseout:function(i){clearTimeout(this.menuTimeout);clearTimeout(this.menuItemTimeout);this.menuTimeout=setTimeout(this.handleMouseout.bind(this),1e3)},cancelMouseout:function(){clearTimeout(this.menuTimeout)},handleMouseover:function(i){if(this.menuItems&&i!=this.activeMenu){var menu=this.menuItems[this.activeMenu];if(menu)menu.style.display='none';this.activeMenu=i;if((menu=this.menuItems[this.activeMenu])){menu.style.left=menu.parentNode.offsetLeft+'px';menu.style.display='block'}}},handleMouseout:function(){this.handleMouseover(-1);this.menuActive=false}})
function Tab(id,hasSpotlight,hasContainer){this.element=getById(id);this.hasSpotlight=hasSpotlight;this.tabItems=[];this.tablistItems=[];this.activeTab=1;this.toggleTimer=null;this.activeCallback=null;this.init(hasContainer)};Object.extend(Tab.prototype,{init:function(hasContainer){if(this.element){var ul=document.createElement('ul'),li,a,tab=this.element.firstChild,i=1,c=1;if(hasContainer)while(tab){if(tab.nodeType==1){tab=tab.firstChild;break};tab=tab.nextSibling};while(tab){if(tab.nodeType==1){this.tabItems[i]=tab;li=document.createElement('li');a=document.createElement('a');a.setAttribute('href',window.location.href+'#'+tab.id);a.appendChild(document.createTextNode(this.hasSpotlight&&i==1?'spotlight':c++));addEvent(a,'click',function(e){e.preventDefault()});addEvent(a,'mouseover',this.setActive.bind(this,i,true));li.appendChild(a);if(i!=this.activeTab){tab.style.display='none'}else addClass(li,'active');this.tablistItems[i]=li;ul.appendChild(li);i++};tab=tab.nextSibling};this.element.insertBefore(ul,this.element.firstChild);addEvent(this.element,'mouseout',this.startToggle.bind(this));addEvent(this.element,'mouseover',this.stopToggle.bind(this));this.startToggle();addCleanupHandler(this,['activeCallback','element','tabItems','tablistItems'],'stopToggle')}},setActive:function(i,doCallback,e){if(i!=this.activeTab){if(this.activeTab){this.tabItems[this.activeTab].style.display='none';removeClass(this.tablistItems[this.activeTab],'active')};this.activeTab=i;this.tabItems[this.activeTab].style.display='';addClass(this.tablistItems[this.activeTab],'active');if(this.activeCallback&&doCallback)this.activeCallback(i,false)};if(e)e.preventDefault()},toggle:function(){var i=this.activeTab+1;if(!this.tabItems[i])i=1;this.setActive(i,true);this.startToggle()},startToggle:function(){this.stopToggle();this.toggleTimer=setTimeout(this.toggle.bind(this),Math.round(4e4/(this.activeTab+1)))},stopToggle:function(){if(this.toggleTimer){clearTimeout(this.toggleTimer);this.toggleTimer=null}}})
function SuperTab(id,hasSpotlight){this.tab=new Tab(id,hasSpotlight);this.tabList=getById(id+'List');this.hasSpotlight=hasSpotlight;this.tablistItems=[];this.activeItem=0;this.timer=null;this.init()};Object.extend(SuperTab.prototype,{init:function(){if(this.tabList){var listItems=this.tabList.getElementsByTagName('li'),li,i=0,j,spotlightOffset=this.hasSpotlight?1:0;while((li=listItems[i++])){if(spotlightOffset&&hasClass(li,'spotlight')){j=1;spotlightOffset=0}else j=i+spotlightOffset;if(this.tab.tabItems[j]){addEvent(li,'mouseover',this.showDelayed.bind(this,j,true));addEvent(li,'mouseout',this.clearTimer.bind(this,true));this.tablistItems[j]=li}};this.tab.activeCallback=this.setActive.bind(this);this.setActive(this.tab.activeTab,false)};addCleanupHandler(this,['tablistItems','tabList','tab'])},setActive:function(i,doCallback){if(i!=this.activeItem){if(this.activeItem)removeClass(this.tablistItems[this.activeItem],'active');this.activeItem=i;addClass(this.tablistItems[this.activeItem],'active');if(doCallback){this.tab.setActive(i,false);this.tab.stopToggle()}}},showDelayed:function(i,bool){this.clearTimer();this.timer=setTimeout(this.setActive.bind(this,i,bool),300)},clearTimer:function(startToggle){if(this.timer){clearTimeout(this.timer);this.timer=null;if(startToggle&&!this.tab.toggleTimer)this.tab.startToggle()}}})
function RefreshTimer(){if(this==window)return new RefreshTimer();if(RefreshTimer.instance)return RefreshTimer.instance;this.timer=null;this.counter=0;this.lastActivity=0;this.refreshes={};this.inactiveTrigger=600;this.paused=false;this.suspended=false;return(RefreshTimer.instance=this)};Object.extend(RefreshTimer.prototype,{add:function(label,callback,interval){this.refreshes[label]={callback:callback,interval:interval,execute:this.counter+interval};if(this.timer==null){addEvent(window,'mousemove',this.stayActive.bind(this));addEvent(window,'focus',this.stayActive.bind(this));addCleanupHandler(this,['refreshes'],'clearTimer');this.start()};return this.refreshes[label]},remove:function(label){if(label in this.refreshes)delete this.refreshes[label]},stayActive:function(){this.lastActivity=this.counter;if(this.suspended&&!this.paused)this.resume()},start:function(){this.timer=setTimeout(this.execute.bind(this),1e3)},suspend:function(){window.status='Suspending timers';this.suspended=true},pause:function(){window.status='Pausing timers';this.paused=true},resume:function(){this.clearTimer();window.status='Resuming timers';this.suspended=false;this.paused=false;this.start()},execute:function(){this.counter++;if(!this.paused&&!this.suspended)if(this.counter-this.lastActivity>this.inactiveTrigger){this.counter--;this.suspend()}else{window.status='';if('global'in this.refreshes&&this.refreshes['global']['execute']<=this.counter){this.refreshes['global']['callback']();return};for(var refresh in this.refreshes)if(this.refreshes[refresh]['execute']<=this.counter){this.refreshes[refresh]['execute']=this.counter+this.refreshes[refresh]['interval'];this.refreshes[refresh]['callback'](this.counter)}};this.start()},clearTimer:function(){if(this.timer){clearTimeout(this.timer);this.timer=null}},getCounter:function(){return this.counter}})
function Tracker(section,settings){initTracker(section,settings)}
function initTracker(section,settings){var tracker=getById('utracker'),utracker=false,timer=null;if(tracker){positionTracker();if(window.DomLoaded)DomLoaded.load(utracker_stretch);if(window.UserID&&window.Tracker&&settings)utracker=new Tracker(tracker,section,settings);function foldout(){clearTimeout(timer);if(!utracker||utracker.order.length)addClass(tracker,'foldout')};function foldinDelayed(){timer=setTimeout(foldin,500)};function foldin(){if(!utracker||utracker.foldinCheck()){removeClass(tracker,'foldout')}else foldinDelayed()};addEvent(tracker,'mouseenter',foldout);addEvent(tracker,'mouseleave',foldinDelayed)}}
function utracker_stretch(){var utracker=getById('utracker'),contentWrapper=getById('contentWrapper'),channelNav=getById('channelNav');if(utracker&&contentWrapper){var ch=contentWrapper.clientHeight,nh=utracker.clientHeight+(channelNav?channelNav.clientHeight:0);if(ch&&ch<nh)if(typeof contentWrapper.style.minWidth=='undefined'){contentWrapper.style.height=nh+'px'}else contentWrapper.style.minHeight=nh+'px'}}
function positionTracker(){var utracker=getById('utracker');if(utracker){var top=88,channelNav=getById('channelNav');if(channelNav)top=channelNav.offsetTop+channelNav.clientHeight-8;utracker.style.top=top+'px'}}
function initChannelNavToggle(){var page=getById('page');if(page&&page.className!='notracker'){var channelNav=getById('channelNav');if(channelNav){var logoPointer=getById('logopointer');if(logoPointer)if(hasClass(page,'trackerright')){logoPointer.style.cursor='default';logoPointer.title='';logoPointer.onclick=function(){}}else{logoPointer.style.cursor='pointer';logoPointer.title='Rubriekenkiezer tonen/verbergen';logoPointer.onclick=toggleChannelNav};if(getCookie('channel')=='off')addClass(channelNav,'hidden')}}}
function toggleChannelNav(){var channelNav=getById('channelNav');if(channelNav){var hide=!hasClass(channelNav,'hidden');if(hide){addClass(channelNav,'hidden')}else removeClass(channelNav,'hidden');setCookie('channel',(hide?'off':'on'));positionTracker();if(!hide)utracker_stretch()}}
function initMoreRelatedArticles(){var relateLists=getElementsByClassName('relatedArticles','ul'),i=0,relateLists,p,span;while((relateList=relateLists[i++]))if(getElementsByClassName('more','li',relateList).length){span=document.createElement('span');span.appendChild(document.createTextNode(' '));p=document.createElement('p');p.appendChild(span);p.onclick=toggleMoreRelatedArticles;relateList.parentNode.insertBefore(p,relateList.nextSibling);p.onclick()}}
function toggleMoreRelatedArticles(){var relateList=this.previousSibling;if(hasClass(relateList,'relatedArticles'))if(hasClass(relateList,'hideMore')){removeClass(relateList,'hideMore');this.className='less';this.firstChild.firstChild.nodeValue='Toon minder items';if(!relateList.ellipsed&&window.ellipsis){ellipsis(relateList);relateList.ellipsed=true}}else{addClass(relateList,'hideMore');this.className='more';this.firstChild.firstChild.nodeValue='Toon alle items ('+relateList.getElementsByTagName('li').length+')'}}
function Poll(id){this.pollId=id;this.init()};Object.extend(Poll.prototype,{init:function(){this.pollForm=document.getElementById('poll'+this.pollId);this.pollContainer=null;if(this.pollForm){addClass(this.pollForm,'jsenabled');var labels=this.pollForm.getElementsByTagName('label'),label,option,i=0;while((label=labels[i++])){if(label.htmlFor&&(option=document.getElementById(label.htmlFor))&&!option.disabled){addEvent(label,'mouseover',this.optionMouseOver);addEvent(label,'mouseout',this.optionMouseOut);addEvent(label,'click',this.optionSelect.bind(this,option))};if(option&&option.checked)addClass(label,'selected')};labels=null,label=null,option=null;addCleanupHandler(this,['pollForm','pollContainer'])}},optionMouseOver:function(){addClass(this,'hover')},optionMouseOut:function(){removeClass(this,'hover')},optionSelect:function(option,e){var result=Ajax().sendRequest(getXmlHttpUrl('frontpage','poll','vote','PollID='+this.pollId),{method:'POST',type:'text',async:false,nocache:true,appendSid:true},'option='+option.value);if(result){this.showVotes(result)}else this.pollForm.submit();if(e)e.preventDefault();return false},getVotes:function(){var result=Ajax().sendRequest(getXmlHttpUrl('frontpage','poll','show','PollID='+this.pollId),{method:'GET',type:'text',async:false,nocache:true});if(result)this.showVotes(result)},showVotes:function(result){if(!this.pollContainer){this.pollContainer=this.pollForm.parentNode;this.pollContainer.removeChild(this.pollForm)};this.pollContainer.innerHTML=result;this.init()}})
function showSearchOptions(){var searchOptionsBox=getById('searchOptions');if(searchOptionsBox){searchOptionsBox.style.display='block';addEvent(document,'click',hideSearchOptions)}}
function hideSearchOptions(e){var target=e.target||e.srcElement;while(target){if(target.className=='submit')break;if(target.id=='searchbox')return false;target=target.parentNode};getById('searchOptions').style.display='none';removeEvent(document,'click',hideSearchOptions);return true}
function openSocialMediaPopup(a){var handle=false;try{handle=window.open(a.href,'socialmedia','toolbar=no,location=no,menubar=no,scrollbars=yes,width=800,height=470,resizable=yes,status=no');if(handle)handle.focus()}catch(e){};trackEvent('Share',a.title.replace(/^Deel (via|op) /,''));return!!handle}
function toggleSocialButtonPref(link){var social=getById('socialButtons');if(social){var value=social.className=='noShow'?1:0;Ajax().sendRequest(getXmlHttpUrl('frontpage','updateShowSocial'),{method:'POST',type:'json',async:false,appendSid:true},'value='+value);if(!value){social.className='noShow';link.firstChild.nodeValue='Social sharing inschakelen';return false}};return true}
var dblc_writebanner=true,dblc_tile=1,dblc_ord,dblc_serverup=true,dblc_firstdone=false,dblc_waitserver=4e3,dblc_reduction=0
function dblc_testserver(){if(!dblc_firstdone)if(dblc_waitserver>0){dblc_waitserver-=200;setTimeout('dblc_testserver()',200)}else{dblc_serverup=false;if(is.ie)document.scripts['dblc_tag1'].src='//'}}
function dblc_writeTag(dblc_size,dblc_type,whenActiveTab,dblc_vars){if(dblc_serverup){if(whenActiveTab&&window.tabs&&window.tabs.activeTab!=whenActiveTab)return;var reduce='dblc_reduce'in window;if(dblc_tile==1&&reduce){dblc_reduction=(dblc_reduce.formats&&dblc_reduce.formats.all)||parseFloat(dblc_reduce)||0;dblc_writebanner=Math.random()>dblc_reduction};var _dblc_writebanner=dblc_writebanner;if(reduce&&dblc_reduce.formats&&dblc_type in dblc_reduce.formats){reduce=dblc_reduce.formats[dblc_type];if(!_dblc_writebanner){if(!reduce||(reduce<dblc_reduction&&Math.random()>reduce/dblc_reduction)){_dblc_writebanner=1;dblc_tile=1}}else if(reduce==1||(reduce>dblc_reduction&&Math.random()<reduce*(1-dblc_reduction)))_dblc_writebanner=0};if(_dblc_writebanner){if(dblc_tile==1){dblc_ord=Math.floor(Math.random()*1e16);setTimeout('dblc_testserver()',200)};if(dblc_type=='tb')if((screen.height&&screen.height<800)||(is.ieVersion<7))dblc_size=dblc_size.replace(/,(1056x180|1208x150)/g,'');if(dblc_type=='re'&&/,(300x600)/g.test(dblc_size)){var rectangleDiv=document.getElementById('b_re');if(rectangleDiv){var sidebar=rectangleDiv.parentNode,siblings=sidebar.parentNode.childNodes,contentSection;for(i=0;i<siblings.length;i++)if(hasClass(siblings[i],'content')||hasClass(siblings[i],'pwContent')){contentSection=siblings[i];break};if(contentSection){var contentHeight=contentSection.clientHeight,sidebarHeight=sidebar.clientHeight+600,difference=contentHeight-sidebarHeight;if(difference<-350)dblc_size=dblc_size.replace(/,(300x600)/g,'')}else dblc_size=dblc_size.replace(/,(300x600)/g,'')}};if(document._write)document.write=document._write;document.write('<script type="text/javascript" id="dblc_tag'+dblc_tile+'" src="http://ad.nl.doubleclick.net/adj/vnumedia.tweak'+dblc_channel+'.nl/'+dblc_zone+';keyword='+dblc_keyword+';sz='+dblc_size+';tile='+dblc_tile+(dblc_type=='tb'?';dcopt=ist':'')+(dblc_ctry?';ctry='+dblc_ctry:'')+(dblc_vars?';'+dblc_vars:'')+';ord='+dblc_ord+'?"><\/script>')};dblc_tile++}}
function dblc_surpressBanner(type){if(!('dblc_reduce'in window))window.dblc_reduce={};if(!dblc_reduce.formats)dblc_reduce={formats:{all:parseFloat(dblc_reduce)||0}};dblc_reduce.formats[type]=1};var topBannerType=null
function prepareTopBanner(type){topBannerType=type};var loadedBanners={}
function bannerCheck(type,adReplacement,adReplacementData){dblc_firstdone=true;if(loadedBanners[type])return;var el_tmp=getById('b_'+type+'_tmp'),page,el;if(el_tmp){var bannerAvailable=false,interstitial=false;if(type=='tb'&&topBannerType&&topBannerType!='maybe'){bannerAvailable=topBannerType!='floorad'}else bannerAvailable=el_tmp.offsetHeight>40||(interstitial=el_tmp.innerHTML.indexOf('Interstitial')>-1)||(el_tmp.innerHTML.indexOf('817-grey.gif')==-1&&el_tmp.innerHTML.indexOf('s0.2mdn.net/dot.gif')==-1&&el_tmp.innerHTML.indexOf('EXPANDO_PLACEHOLDER')==-1&&/<(object|embed|img|span) /i.test(el_tmp.innerHTML));if(bannerAvailable){try{if(bannerSync(type,el_tmp,interstitial))return}catch(e){};loadedBanners[type]=el_tmp}else{if(type=='tb')if(topBannerType=='maybe')noTakeOver();if(adReplacement&&(type!='ad'||!loadedBanners.re))if((el=getById('b_'+type))){el.innerHTML='';if(adReplacement=='tl_sidebar'){create_textlinks('b_'+type,adReplacementData)}else{if(el.className=='advertorial')el.className='';create_google_advertorial('b_'+type,adReplacementData)}}}}}
function bannerSync(type,el_tmp,interstitial){el_tmp=el_tmp||loadedBanners[type];if(el_tmp&&typeof el_tmp=='object'){var el=getById('b_'+type);if(el){if(type=='tb'&&topBannerType){if(topBannerType=='floorad'){el.style.display='none';return true}}else if(el_tmp.innerHTML.indexOf('EXPANDO_PLACEHOLDER')>-1){el.style.display='none';return true};if(is.opera||is.ie){var script=el_tmp.getElementsByTagName('script'),i=script.length;while(i--)if(!script[i].htmlFor)script[i].parentNode.removeChild(script[i])};var width=el_tmp.offsetWidth,height=el_tmp.offsetHeight,m;if(type=='tb'){var fullTakeover=false,page;switch(topBannerType){case'maybe':noTakeOver();break;case'full':fullTakeover=document.getElementById('backgroundTakeover');if(!fullTakeover){fullTakeover=document.createElement('div');fullTakeover.id='backgroundTakeover';document.body.insertBefore(fullTakeover,document.body.firstChild)};fullTakeover.appendChild(el);if((page=getById('page'))&&!page.style.backgroundColor)page.style.backgroundColor='transparent';break};if(!fullTakeover){if(el_tmp.innerHTML.indexOf('XLHeader')>-1){width=1056;height=180}else if(el_tmp.innerHTML.indexOf('_1056x120')>-1){width=1056;height=120}else if(el_tmp.innerHTML.indexOf('_840x370')>-1){width=840;height=370}else if(el_tmp.innerHTML.indexOf('_728x90')>-1){width=728;height=90}else if(width<468)if((m=/width(:\s*|="?)(468|728|840|1056|1208)/i.exec(el_tmp.innerHTML)))width=+m[2];if(width>852){var header=getById('headerWrapper');if(header){var replacement=document.createElement('div');replacement.id='headerReplacement';replacement.appendChild(el);if(height<120)if((m=/height(:\s*|="?)(120|180)/i.exec(el_tmp.innerHTML)))height=+m[2];replacement.style.height=height>=180?'180px':(height>=120?'120px':'auto');header.appendChild(replacement);var logopointer=getById('logopointer');if(logopointer)logopointer.style.display='none';positionTracker()}}else if(width>740){el.className='leaderBoard';el.style.width='auto';if(width==840){var content=getElementsByClassName('content')[0],h1,sidebar;if(content){content.style.cssText='position:relative;z-index:99;background:#fff';if((h1=node_before(content,'h1'))){content.insertBefore(h1,content.firstChild);h1.style.whiteSpace='normal'};if((sidebar=node_after(content,'div')))sidebar.style.paddingTop='268px'};dblc_surpressBanner('re')}}else if(width>480){el.className='leaderBoard';el.style.width='728px'}else{el.className='topBanner';el.style.width='468px'}}}else if(type=='re'){if(width>336||width<300)width=336;el.style.width=width+'px'};if(/z-index:\s*\d{3}/i.test(el_tmp.innerHTML)||el_tmp.innerHTML.indexOf('Atlas')>-1){el.style.position='relative';el.style.zIndex=99};while(el_tmp.hasChildNodes()){tmp=el_tmp.removeChild(el_tmp.firstChild);el.appendChild(tmp)};if(interstitial){el.style.margin=0;el.style.height=0;el.style.overflow='hidden'};el.style.display='block';if(window.additionalBannerSyncer)additionalBannerSyncer(type,el.style.width);return true}};return false}
function noTakeOver(){var page=getById('page');if(page)removeClass(page.parentNode,'takeover');prepareTopBanner(null)}
function registerTakeover(type,backgroundImage,backgroundColor,tabContainerId,trackerBackgroundImage,trackerBackgroundColor){var page=getById('page'),html;if(page&&(html=document.documentElement)){prepareTopBanner(type);addClass(page.parentNode,type=='full'?'takeover':'takeoverlight');if(is.ie)addClass(page.parentNode,'MSIE');html.style.background=(backgroundColor||'#414141')+(backgroundImage?' url('+backgroundImage+') no-repeat top center':'');if(trackerBackgroundColor)page.style.backgroundColor=trackerBackgroundColor;if(trackerBackgroundImage)page.style.backgroundImage='url('+trackerBackgroundImage+')';if(type=='full'&&tabContainerId)addResizeHandler(positionTakeoverTabContainer,tabContainerId)}}
function positionTakeoverTabContainer(tabContainerId){if(window.takeoverResizeTimer){clearTimeout(window.takeoverResizeTimer);window.takeoverResizeTimer=null};var tabContainer=document.getElementById(tabContainerId);if(tabContainer){tabContainer.style.position='absolute';tabContainer.style.top='250px';tabContainer.style.left=getTakeoverTabContainerLeftPosition()+'px'}else window.takeoverResizeTimer=setTimeout(function(){positionTakeoverTabContainer(tabContainerId)},100)}
function getTakeoverTabContainerLeftPosition(){var layout=getById('layout'),page=getById('page'),utracker,pos=layout.offsetLeft+layout.offsetWidth;if(hasClass(page,'trackerright'))if((utracker=getById('utracker'))&&utracker.offsetWidth)pos+=utracker.offsetWidth+10;return pos}
function create_textlinks(id,replaceData){var el=getById(id);if(!el)return false;if(!replaceData||!(replaceData instanceof Array)||!replaceData.length){el.style.display='none';return false};var s=['<div class="textadContainer boxCorner4"><div class="textadBg"><div class="textadTop"><small>Gesponsorde links</small></div><table class="textadTable">'],i=0,textlink,no_external;while((textlink=replaceData[i++])){no_external=/http:\/\/([a-z]+\.)?tweakers\.net\//.test(textlink.link);s.push('<tr><td><img src="'+(textlink.image.indexOf('http://')===0?textlink.image:ImgURL+'g/banners/'+textlink.image)+'" alt="'+textlink.client+' logo" width="14" height="14"></td><td class="ellipsis textadContent"><a href="'+textlink.link+'"'+(no_external?'':' target="_blank"')+' title="'+textlink.title.replace(/<[^>]*>/g,'')+'">'+textlink.title+textlink.text.replace(/\[timestamp\]/,new Date().getTime())+'</a></td></tr>')};s.push('</table><div class="textadBottom"><div class="hr"><hr></div></div></div></div>');el.innerHTML=s.join('');el.style.height='auto';el.style.display='block';return true}
function create_tnet_banner(ad,target){var el,s;if(ad&&(el=target&&document.getElementById(target))){s=['<small><a href="http://tweakers.net/adverteren" title="Adverteren op Tweakers.net">advertentie<\/a><\/small>'];s.push('<a href="'+ad.clickurl+'" class="img" target="_blank"><img src="'+ad.img+'"><\/a>');s.push('<p class="title"><a href="'+ad.clickurl+'" target="_blank">'+ad.title+'<\/a><\/p>');s.push('<p>'+ad.text+' <a href="'+ad.clickurl+'" target="_blank">Meer informatie &raquo;<\/a><\/p>');if(ad.trackingpixel)s.push('<img src="'+ad.trackingpixel+'" style="display:none">');el.innerHTML=s.join('');el.className='tnetAdvertorial';el.style.display='block';if(is.ie)addClass(document.body,'MSIE');loadedBanners[target.replace(/^b_/,'')]=true}}
function create_pw_sidebar_textlink(ad,sizeid){var el,s;if(ad&&(el=sizeid&&document.getElementById(sizeid))){s='<div style="height: auto; display: block;"><div class="textadContainer boxCorner4'+(ad.style?' '+ad.style:'')+'"><div class="textadBg"><div class="textadTop"><small>Gesponsorde links</small></div><table class="textadTable"><colgroup><col width="22"><col></colgroup><tbody><tr><td><a href="'+ad.clickurl+'"><img src="'+ad.img+'"></a></td><td class="ellipsis textadContent"><a href="'+ad.clickurl+'" title="'+ad.title+'" class="textlinkText">'+ad.title+'</a><a href="'+ad.clickurl+'" class="textlinkButton boxCorner3">'+ad.buttonTitle+'</a></td></tr></tbody></table><div class="textadBottom"><div class="hr"><hr></div></div></div></div></div>';el.innerHTML=s;el.className='frontpageAdItem';el.style.display='block'}};var current_adsense_position='',current_clickprefixurl=''
function create_google_advertorial(id,adsenseData,clickprefixurl){if(window.tnet_google_ad_client&&adsenseData){current_adsense_position=id;current_clickprefixurl=clickprefixurl;document.write("<script type='text/javascript'>var google_page_url=adsense_page_url,google_language='nl',google_ad_client='"+window.tnet_google_ad_client+"',"+('slot'in adsenseData?"google_ad_slot='"+adsenseData.slot+"',":"google_ad_type='text',google_ad_channel='"+adsenseData.channel+"',")+(window.dblc_zone&&window.dblc_zone=='test'?"google_adtest='on',":"")+"google_ad_output='js',google_max_num_ads='"+adsenseData.numads+"';<\/script><script type='text/javascript' src='http://pagead2.googlesyndication.com/pagead/show_ads.js'><\/script>")}else getById(id).style.display='none'}
function create_google_afs(id,query,adsenseData){if(window.tnet_google_ad_client&&adsenseData){current_adsense_position=id;current_clickprefixurl='';document.write("<script type='text/javascript'>google_afs_hl='nl',google_afs_query='"+query.escapeJs()+"',google_afs_client='"+window.tnet_google_ad_client+"',google_afs_channel='"+adsenseData.channel+"',"+(window.dblc_zone&&window.dblc_zone=='test'?"google_afs_adtest='on',":"")+"google_afs_ad='"+adsenseData.adconfig+"';<\/script><script type='text/javascript' src='http://www.google.com/afsonline/show_afs_ads.js'><\/script>")}else getById(id).style.display='none'}
function google_ad_request_done(google_ads,afs){var el=current_adsense_position&&getById(current_adsense_position),l;if(!el)return false;if((l=google_ads.length)==0){el.style.display='none';return false};var feedbackurl=afs?'http://services.google.com/feedback/online_hws_feedback':'http://services.google.com/feedback/abg?url='+encodeURIComponent(adsense_page_url)+'&hl=nl&client='+google_ad_client,s=['<div class="textadContainer boxCorner4"><div class="textadBg"><div class="textadTop"><small><a href="'+feedbackurl+'" class="adsensefburl">Ads door Google</a></small></div>'],i=0,google_ad;if(!window.defaultStatus)window.defaultStatus='';var width=current_adsense_position in Set('b_re','as_rectangle','as_pw_rectangle','as_articles','pw_afs_sidebar')?100:Math.floor(100/l);while((google_ad=google_ads[i++])){if(is.ie){google_ad.line1=cp1252Fix(google_ad.line1);google_ad.line2=cp1252Fix(google_ad.line2);google_ad.line3=cp1252Fix(google_ad.line3)};var url=current_clickprefixurl?current_clickprefixurl+encodeURIComponent(google_ad.url.replace(/&amp;/g,'&')):google_ad.url;s.push((l>1?'<div class="textadColumn" style="width:'+width+'%">':'')+'<div class="textadContent"><h4><a href="'+url+'" onmouseover="window.status=\'ga naar '+google_ad.visible_url+'\';return true" onmouseout="window.status=window.defaultStatus;return true">'+google_ad.line1+'</a></h4>'+google_ad.line2+(google_ad.line3?' '+google_ad.line3:'')+'<br><a class="url" href="'+url+'" onmouseover="window.status=\'ga naar '+google_ad.visible_url+'\';return true" onmouseout="window.status=window.defaultStatus;return true">'+google_ad.visible_url+'</a></div>'+(l>1?'</div>':''))};s.push('<div class="textadBottom"><div class="hr"><hr></div></div></div></div>');el.innerHTML=s.join('');el.style.height='auto';el.style.display='block';return true}
function google_afs_request_done(google_ads){return google_ad_request_done(google_ads,true)}
function cp1252Fix(string){var charMap={128:8364,381:180};return string.replace(/[\u0080\u017d]/g,function(c){return String.fromCharCode(charMap[c.charCodeAt(0)])})}
function Tracker(tracker,section,settings){this.tracker=tracker;this.section=section;this.settings=settings;this.ajax=null;this.propertyImg=null;this.trackerItems={};this.trackerHeadlines={};this.trackerItemConfig={};this.trackerRefreshes={};this.order=[];this.drag=null;this.dummyItem=null;this.updateOrder=false;this.sy=0;this.dy=0;this.ph=0;this.nh=0;this.highContrast=0;this.position='l';this.fixate=0;this.init()};Object.extend(Tracker.prototype,{init:function(){if((this.ajax=new Ajax()).getRequestObject(true)){if('highContrast'in this.settings)this.highContrast=this.settings['highContrast']['config']||0;if('position'in this.settings)this.position=this.settings['position']['config']||'l';if('fixate'in this.settings)this.fixate=this.settings['fixate']['config']||0;this.preloadThrobber();this.dummyItem=document.createElement('div');this.dummyItem.className='dummy';addEvent(this.tracker,'mousemove',this.dragDo.bind(this));addEvent(document,'mouseup',this.dragStop.bind(this));var trackerItems=getElementsByClassName('trackeritem','div',this.tracker),trackerItem,i=0,l,trackerId;while((trackerItem=trackerItems[i])){trackerId=trackerItem.getAttribute('id'),l=trackerId.lastIndexOf('-')+1;if(l&&(trackerId=trackerId.substr(l))){this.order.push(trackerId);this.trackerItems[trackerId]=trackerItem;this.initTrackerItem(trackerId)};i++};var propertiesHolder=document.createElement('div'),configImage;propertiesHolder.id='trackerSettings';this.propertyImg=HTMLBuilder().built({n:'span',a:{title:'Tracker keuzes',className:'sprite choices',onclick:this.trackerChoices.bind(this)},t:'Tracker keuzes'});propertiesHolder.appendChild(this.propertyImg);if('highContrast'in this.settings){configImage=HTMLBuilder().built({n:'span',a:{title:'Contrast',className:'sprite contrast',onclick:this.toggleOption.bind(this,'highContrast')},t:'Contrast'});propertiesHolder.appendChild(configImage)};if('position'in this.settings){configImage=HTMLBuilder().built({n:'span',a:{title:'Positie',className:'sprite position',onclick:this.toggleOption.bind(this,'position')},t:'Positie'});propertiesHolder.appendChild(configImage)};if('fixate'in this.settings){configImage=HTMLBuilder().built({n:'span',a:{title:'Fixeren',className:'sprite fixate',onclick:this.toggleOption.bind(this,'fixate')},t:'Fixeren'});propertiesHolder.appendChild(configImage)};this.tracker.insertBefore(propertiesHolder,document.getElementById('award'));configImage=null;RefreshTimer().add('trackerRefresh',this.refreshAll.bind(this),60)};addCleanupHandler(this,['ajax','tracker','propertyImg','dummyItem','trackerItems'])},preloadThrobber:function(update){preload('tracker_throbber','g/if/v2/tracker/timer'+(this.highContrast?'_hct':'')+'_ani.gif',update)},foldinCheck:function(){if(this.trackerChoicePopup&&this.trackerChoicePopup.popup.visible)return false;if(this.trackerPropPopup&&this.trackerPropPopup.popup.visible)return false;return true},initTrackerItem:function(trackerId){var header=this.trackerItems[trackerId]&&this.trackerItems[trackerId].getElementsByTagName('h4')[0],img,a;if(header){addClass(header,'active');addEvent(header,'mousedown',this.dragStart.bind(this,trackerId));header.onselectstart=function(){return false};if((a=header.getElementsByTagName('a')[0]))addEvent(a,'mousedown',function(e){e.stopPropagation()});img=document.createElement('span');img.title='Eigenschappen';img.className='tracker_button';addEvent(img,'mousedown',function(e){e.stopPropagation()});addEvent(img,'click',this.trackerProperties.bind(this,img,trackerId));header.appendChild(img);this.refreshInit(trackerId)};header=null,img=null,a=null},trackerProperties:function(propImg,trackerId){if(this.trackerPropPopup===undefined)if((this.trackerPropPopup=new TrackerPropPopup(this)))document.body.appendChild(this.trackerPropPopup.popup.element);if(this.trackerPropPopup&&this.trackerPropPopup.trackerId!=trackerId){this.closeAllPopups();if(this.trackerPropPopup.initContent(trackerId)){var posLeft=this.position=='r'?-339:20;setRelativePosition(this.trackerPropPopup.popup.element,propImg,1,posLeft);RefreshTimer().pause();this.trackerPropPopup.popup.show()}}},trackerChoices:function(){if(this.trackerChoicePopup===undefined)if((this.trackerChoicePopup=new TrackerChoicePopup(this)))document.body.appendChild(this.trackerChoicePopup.popup.element);if(this.trackerChoicePopup)if(this.trackerChoicePopup.popup.visible){this.trackerChoicePopup.closePopup(true)}else{this.closeAllPopups();if(this.trackerChoicePopup.initContent()){var posLeft=this.position=='r'?-240:215;setRelativePosition(this.trackerChoicePopup.popup.element,this.propertyImg,-440,posLeft,100,0);RefreshTimer().pause();this.trackerChoicePopup.popup.show()}}},closeAllPopups:function(){if(this.trackerChoicePopup&&this.trackerChoicePopup.popup.visible)this.trackerChoicePopup.closePopup(true);if(this.trackerPropPopup&&this.trackerPropPopup.popup.visible)this.trackerPropPopup.closePopup(true)},toggleOption:function(option){this.closeAllPopups();var page=getById('page');if(page){switch(option){case'highContrast':if(this.highContrast){removeClass(this.tracker,'hct');this.highContrast=0}else{addClass(this.tracker,'hct');this.highContrast=1};this.preloadThrobber();break;case'position':if(this.position=='r'){page.className=this.fixate?'trackerfixed':'';this.position='l'}else{page.className='trackerright';this.position='r'};positionTracker();utracker_stretch();resizeHandler();initChannelNavToggle();if(SiteMenu.instance)SiteMenu.instance.positionSubMenus();break;case'fixate':if(this.fixate){page.className='';this.fixate=0}else{page.className='trackerfixed';this.fixate=1};resizeHandler();break};this.ajax.sendRequest(getXmlHttpUrl('frontpage','tracker','set_options'),{method:'POST',type:'text',async:true,appendSid:true},'section='+this.section+'&trackerid='+option+'&options%5Bconfig%5D='+this[option])}},dragStart:function(trackerId,e){e=e||event;if(!this.drag){this.drag=trackerId;var trackerItem=this.trackerItems[trackerId],y=trackerItem.offsetTop;addClass(trackerItem,'dragitem');trackerItem.style.top=y+'px';var index=this.order.indexOf(trackerId);this.ph=this.getPreviousTracker(index).clientHeight||0;this.nh=this.getNextTracker(index).clientHeight||0;this.dy=y;this.sy=y-e.clientY;this.dummyItem.style.height=(trackerItem.clientHeight-2)+'px';trackerItem.parentNode.insertBefore(this.dummyItem,trackerItem)};if(e.preventDefault)e.preventDefault()},dragDo:function(e){if(this.drag){e=e||event;var ny=this.sy+e.clientY,trackerId=this.drag;this.trackerItems[trackerId].style.top=ny+'px';var el,index,parent;if(ny-this.dy>this.nh){index=this.order.indexOf(trackerId);if((el=this.getNextTracker(index))){parent=this.dummyItem.parentNode;parent.insertBefore(parent.removeChild(this.dummyItem),el.nextSibling);this.ph=el.clientHeight;this.dy+=this.ph;this.nh=this.getNextTracker(index+1).clientHeight||0;this.order[index]=this.order[index+1];this.order[index+1]=trackerId;this.updateOrder=true}}else if(this.dy-ny>this.ph){index=this.order.indexOf(trackerId);if((el=this.getPreviousTracker(index))){parent=this.dummyItem.parentNode;parent.insertBefore(parent.removeChild(this.dummyItem),el);this.nh=el.clientHeight;this.dy-=this.nh;this.ph=this.getPreviousTracker(index-1).clientHeight||0;this.order[index]=this.order[index-1];this.order[index-1]=trackerId;this.updateOrder=true}}}},dragStop:function(){if(this.drag){var trackerItem=this.trackerItems[this.drag];trackerItem.parentNode.removeChild(trackerItem);removeClass(trackerItem,'dragitem');trackerItem.style.top=0;this.dummyItem.parentNode.replaceChild(trackerItem,this.dummyItem);this.drag=null;if(this.updateOrder){this.updateTrackerOrder();this.updateOrder=false}}},getPreviousTracker:function(i){var previousTracker=false,trackerId;while((trackerId=this.order[--i]))if(this.trackerItems[trackerId].offsetParent){previousTracker=this.trackerItems[trackerId];break};return previousTracker},getNextTracker:function(i){var nextTracker=false,trackerId;while((trackerId=this.order[++i]))if(this.trackerItems[trackerId].offsetParent){nextTracker=this.trackerItems[trackerId];break};return nextTracker},updateTrackerOrder:function(){var postBody=['section='+this.section];for(var i=0;i<this.order.length;i++)postBody.push('volgorde%5B%5D='+this.order[i]);var result=this.ajax.sendRequest(getXmlHttpUrl('frontpage','tracker','set_order'),{method:'POST',type:'json',async:false,appendSid:true,handler:checkJsonResponse},postBody.join('&'));if(result)this.settings=result},refreshInit:function(trackerId){if(this.settings[trackerId]&&this.settings[trackerId]['refresh']){this.trackerRefreshes[trackerId]=RefreshTimer().getCounter()+this.settings[trackerId]['refresh']}else if(this.trackerRefreshes[trackerId])delete this.trackerRefreshes[trackerId]},refreshAll:function(timerCount){var trackerIds=[],trackerId;for(var trackerId in this.trackerRefreshes)if(this.trackerRefreshes[trackerId]<=timerCount){trackerIds.push(trackerId);this.trackerRefreshes[trackerId]=timerCount+this.settings[trackerId]['refresh'];this.refreshTracker(trackerId)};if(trackerIds.length)setTimeout(this.refreshRequest.bind(this,trackerIds,true),500)},refreshTracker:function(trackerId){var tracker=this.trackerItems[trackerId].getElementsByTagName('h4')[0],throbber=document.createElement('img');throbber.src=getPreloadImage('tracker_throbber');throbber.title='Refreshing...';throbber.style.cssText='position:absolute;'+(this.position=='r'?'right':'left')+':3px;top:4px;width:11px;height:11px;';tracker.appendChild(throbber)},refreshRequest:function(trackerId,async){if(trackerId instanceof Array)trackerId=trackerId.join(',');return this.ajax.sendRequest(getXmlHttpUrl('frontpage','tracker','get_items','section='+this.section+'&trackerid='+trackerId),{method:'GET',type:'json',async:!!async,nocache:true,handler:async?this.refreshDone.bind(this,trackerId):checkJsonResponse})},refreshDone:function(trackerIds,response){var trackerData=checkJsonResponse(response);if(trackerData){trackerIds=trackerIds.split(',');var trackerId,tracker,i=0;while((trackerId=trackerIds[i++])){if(trackerId in trackerData)this.builtTracker(trackerId,trackerData[trackerId]);if((tracker=this.trackerItems[trackerId].getElementsByTagName('h4')[0]))tracker.removeChild(tracker.lastChild)}}},getTrackerHeadlines:function(trackerId){var trackerData=this.refreshRequest(trackerId,false);if(trackerData&&trackerId in trackerData)this.builtTracker(trackerId,trackerData[trackerId])},builtTracker:function(trackerId,trackerData){if(trackerData){if('headlines'in trackerData)this.trackerHeadlines[trackerId]=trackerData.headlines;if('itemConfig'in trackerData)this.trackerItemConfig[trackerId]=trackerData.itemConfig};if(this.trackerHeadlines[trackerId]&&this.trackerHeadlines[trackerId]instanceof Array){if(!this.trackerItems[trackerId])this.trackerItems[trackerId]=this.builtTrackerHeader(trackerId);var trackerItem=this.trackerItems[trackerId]&&this.trackerItems[trackerId].getElementsByTagName('ul')[0];if(trackerItem){while(trackerItem.hasChildNodes())trackerItem.removeChild(trackerItem.firstChild);var aantal=this.settings[trackerId]['aantal']||3,i=0,trackerHeadline,showAll=this.trackerItemConfig[trackerId]['showAll'];while((showAll||i<aantal)&&(trackerHeadline=this.trackerHeadlines[trackerId][i++])){trackerHeadline.url=trackerHeadline.url.unescapeHtml();trackerHeadline.caption=trackerHeadline.caption.unescapeHtml();trackerItem.appendChild(HTMLBuilder().built({n:'li',c:[{n:'a',a:{href:trackerHeadline.url,className:(trackerHeadline.channelClass+(trackerHeadline.isNew?' new':'')).trim(),title:(trackerHeadline.channelClass?trackerHeadline.channelClass.ucFirst()+': ':'')+trackerHeadline.caption,target:this.getLinkTarget(trackerId)},c:[{n:'span',a:{className:'time'},t:trackerHeadline.tijd},{n:'#text',v:' '},{n:'span',a:{className:'caption'},t:trackerHeadline.caption}]}]}))};ellipsis(trackerItem);utracker_stretch()}}},builtTrackerHeader:function(trackerId){var trackerItem=null,itemConfig=this.trackerItemConfig[trackerId];if(itemConfig){trackerItem=HTMLBuilder().built({n:'div',a:{className:'trackeritem',id:'tracker-'+trackerId},c:[{n:'h4',c:[{n:'span',a:{className:'time'},t:'00:00'},{n:'#text',v:' '},{n:'a',a:{href:itemConfig.link,target:this.getLinkTarget(trackerId)},t:itemConfig.caption}]},{n:'ul',a:{className:'ellipsis'}}]});this.appendTracker(trackerId,trackerItem)};return trackerItem},showHideTracker:function(trackerId,show){var trackerItem=this.trackerItems[trackerId];if(show){if(!trackerItem){if(!this.trackerHeadlines[trackerId]){this.getTrackerHeadlines(trackerId)}else this.builtTracker(trackerId);this.order.push(trackerId)}else if(!trackerItem.offsetParent)this.appendTracker(trackerId,trackerItem,true)}else if(trackerItem&&trackerItem.offsetParent)trackerItem.parentNode.removeChild(trackerItem)},getLinkTarget:function(trackerId){var itemConfig=this.trackerItemConfig[trackerId];return itemConfig&&itemConfig.rel&&itemConfig.rel=='external'?'_blank':null},appendTracker:function(trackerId,trackerItem,stretch){var index=this.order.indexOf(trackerId);this.tracker.insertBefore(trackerItem,(index>-1&&this.getNextTracker(index))||getElementsByClassName('trackerbottom','div',this.tracker)[0]||this.propertyImg);if(stretch)utracker_stretch()}})
function TrackerPropPopup(tracker){this.tracker=tracker;this.trackerId=0;this.settings=null;this.propertyElements=null;this.popup=null;this.init()};Object.extend(TrackerPropPopup.prototype,{init:function(){this.popup=new Popup(320,this.closePopup.bind(this));addCleanupHandler(this,['tracker','popup','propertyElements'])},initContent:function(trackerId){this.trackerId=trackerId;this.settings=Object.extend({},this.tracker.settings[this.trackerId]);if(!this.tracker.trackerHeadlines[trackerId])this.tracker.getTrackerHeadlines(trackerId);var maxItems=10;if(this.tracker.trackerItemConfig[trackerId]&&this.tracker.trackerItemConfig[trackerId]['max'])maxItems=this.tracker.trackerItemConfig[trackerId]['max'];var caption=this.settings.caption||(this.tracker.trackerItemConfig[trackerId]&&this.tracker.trackerItemConfig[trackerId]['caption'])||trackerId.ucFirst(),showAll=this.tracker.settings[this.trackerId]['showAll']||(this.tracker.trackerItemConfig[trackerId]&&this.tracker.trackerItemConfig[trackerId]['showAll']);this.popup.setContent(HTMLBuilder().built({n:'div',c:[{n:'h4',t:caption+' tracker:'},{n:'table',a:{cellpadding:2,className:'boxCorner3'},c:[('aantal'in this.settings&&!showAll?{n:'tr',c:[{n:'td',a:{width:50},t:'Aantal:'},{n:'td',c:[{o:new Slider({max:maxItems,value:this.settings['aantal']||3,slideArea:this.popup.contentArea,onchange:this.changeAantal.bind(this)}).sliderControl},{n:'span',a:{id:'trackerAantal'},t:' ('+this.settings['aantal']+')'}]}]}:{n:'tr',c:[{n:'td',a:{width:50},t:'Aan/Uit:'},{n:'td',c:{n:'input',a:{type:'checkbox',value:1,checked:true,onchange:this.toggleDisplay.bind(this)}}}]}),('refresh'in this.settings?{n:'tr',c:[{n:'td',a:{width:50},t:'Refresh:'},{n:'td',c:[{o:new Slider({max:5,value:this.settings['refresh'],slideArea:this.popup.contentArea,onchange:this.changeRefresh.bind(this)}).sliderControl},{n:'span',a:{id:'trackerRefresh'},t:this.getRefreshText(this.settings['refresh'])}]}]}:null),{n:'tr',c:{n:'td',a:{colSpan:2,style:'text-align:center'},c:[{n:'input',a:{type:'button',className:'button',value:'Opslaan',onclick:this.saveSettings.bind(this)}}]}}]}]}));this.propertyElements=HTMLBuilder().getIdList();return true},changeAantal:function(aantal){if(this.tracker.settings[this.trackerId]['aantal']==0||aantal==0)this.tracker.showHideTracker(this.trackerId,aantal);this.propertyElements['trackerAantal'].firstChild.nodeValue=' ('+aantal+')';this.tracker.settings[this.trackerId]['aantal']=aantal;this.tracker.builtTracker(this.trackerId)},toggleDisplay:function(){var displayTracker=this.tracker.settings[this.trackerId]['oldAantal']||0;this.tracker.showHideTracker(this.trackerId,displayTracker>0);this.tracker.settings[this.trackerId]['oldAantal']=this.tracker.settings[this.trackerId]['aantal'];this.tracker.settings[this.trackerId]['aantal']=(displayTracker==0?0:1);this.tracker.builtTracker(this.trackerId)},getRefreshText:function(aantal){return' '+(aantal?aantal+' '+(aantal>1?'minuten':'minuut'):'uit')},changeRefresh:function(aantal){this.propertyElements['trackerRefresh'].firstChild.nodeValue=this.getRefreshText(aantal);this.tracker.settings[this.trackerId]['refresh']=aantal},saveSettings:function(){var postBody=['section='+this.tracker.section,'trackerid='+this.trackerId],settings=this.tracker.settings[this.trackerId];for(var option in settings)if(settings.hasOwnProperty(option))postBody.push(encodeURIComponent('options['+option+']')+'='+encodeURIComponent(settings[option]));var result=this.tracker.ajax.sendRequest(getXmlHttpUrl('frontpage','tracker','set_options'),{method:'POST',type:'json',async:false,appendSid:true,handler:checkJsonResponse},postBody.join('&'));if(result)this.tracker.settings=result;this.tracker.refreshInit(this.trackerId);this.closePopup()},closePopup:function(reset){if(reset){this.tracker.showHideTracker(this.trackerId,true);this.tracker.settings[this.trackerId]={};Object.extend(this.tracker.settings[this.trackerId],this.settings);this.tracker.builtTracker(this.trackerId)};this.trackerId=0;this.popup.close();RefreshTimer().resume()}})
function TrackerChoicePopup(tracker){this.tracker=tracker;this.popup=null;this.init()};Object.extend(TrackerChoicePopup.prototype,{init:function(){this.popup=new Popup(220,this.closePopup.bind(this));addCleanupHandler(this,['tracker','popup'])},initContent:function(){var options=[],settings,caption;for(var trackerId in this.tracker.settings)if(this.tracker.settings.hasOwnProperty(trackerId)){settings=this.tracker.settings[trackerId];if('aantal'in settings){caption=settings.caption||(this.tracker.trackerItemConfig[trackerId]&&this.tracker.trackerItemConfig[trackerId]['caption'])||trackerId.ucFirst();options.push({n:'tr',c:[{n:'td',a:{width:20},c:{n:'input',a:{type:'checkbox',id:'showtracker_'+trackerId,defaultChecked:!!settings.aantal,onclick:this.toggleTracker.bind(this,trackerId)}}},{n:'td',c:{n:'label',a:{htmlFor:'showtracker_'+trackerId},t:caption}}]})}};options.push({n:'tr',c:{n:'td',a:{colSpan:2,style:'text-align:center'},c:{n:'input',a:{type:'button',className:'button',value:'Opslaan',onclick:this.saveSettings.bind(this)}}}});this.popup.setContent(HTMLBuilder().built({n:'div',c:[{n:'h4',t:'Tracker keuzes:'},{n:'table',a:{cellpadding:2,className:'boxCorner3'},c:options}]}));return true},toggleTracker:function(trackerId,e){e=e||event;var target=e.target||e.srcElement,checked=target.checked;this.tracker.showHideTracker(trackerId,checked)},saveSettings:function(){var trackerId,trackerItem,index;for(trackerId in this.tracker.settings)if(this.tracker.settings.hasOwnProperty(trackerId)){trackerItem=this.tracker.trackerItems[trackerId];index=this.tracker.order.indexOf(trackerId);if(trackerItem&&trackerItem.offsetParent){if(index<0)this.tracker.order.push(trackerId);if(!this.tracker.settings[trackerId]['aantal'])this.tracker.initTrackerItem(trackerId)}else if(index>-1)this.tracker.order.splice(index,1)};this.tracker.updateTrackerOrder();this.closePopup()},closePopup:function(reset){if(reset){var trackerId,trackerItem,index;for(trackerId in this.tracker.settings)if(this.tracker.settings.hasOwnProperty(trackerId)){trackerItem=this.tracker.trackerItems[trackerId];if(trackerItem)if(this.tracker.settings[trackerId]['aantal']){if(!trackerItem.offsetParent)this.tracker.appendTracker(trackerId,trackerItem,true)}else{if(trackerItem.offsetParent)trackerItem.parentNode.removeChild(trackerItem);if((index=this.tracker.order.indexOf(trackerId))>-1)this.tracker.order.splice(index,1)}}};this.popup.close();RefreshTimer().resume()}})
function Slider(options){this.options=options;this.sliderControl=null;this.slider=null;this.min=0;this.max=0;this.step=0;this.value=0;this.onchange=null;this.drag=false;this.mx=0;this.cx=0;this.sx=0;this.x=0;this.init()};Object.extend(Slider.prototype,{init:function(){if(this.options){this.min=parseInt(this.options.min||0,10);this.max=parseInt(this.options.max,10);if('step'in this.options){this.step=parseInt(this.options.step,10)}else this.step=Math.ceil((this.max-this.min)/10);this.value=parseInt(this.options.value,10);this.onchange=this.options.onchange;var width=(((this.max-this.min)/this.step)*20)+3;this.mx=width-5;this.sliderControl=document.createElement('div');this.sliderControl.className='sliderControl';this.sliderControl.style.width=width+'px';this.slider=document.createElement('div');this.slider.className='slider';this.sliderControl.appendChild(this.slider);this.sliderSnap();addEvent(this.slider,'mousedown',this.sliderStart.bind(this));this.slider.onselectstart=function(){return false};addEvent(this.sliderControl,'click',this.sliderClick.bind(this));addEvent(this.options.slideArea||document,'mousemove',this.sliderMove.bind(this));addEvent(document,'mouseup',this.sliderStop.bind(this));addCleanupHandler(this,['sliderControl','slider'])}},sliderStart:function(e){e=e||event;this.sx=e.clientX;this.drag=true},sliderMove:function(e){e=e||event;if(this.drag){var nx=this.cx-this.sx+e.clientX;if(nx<-4)nx=-4;if(nx>this.mx)nx=this.mx;this.slider.style.left=nx+'px';var nv=this.min+Math.round(((nx+4)/20)*this.step);if(nv!=this.value)this.sliderOnChange(nv)}},sliderClick:function(e){e=e||event;var target=e.target||e.srcElement;if(!this.drag&&target!=this.slider){var nx=e.layerX||e.offsetX||0,nv=this.min+Math.round((nx/20)*this.step);if(nv!=this.value)this.sliderOnChange(nv,true)}},sliderStop:function(e){this.drag=false;this.sliderSnap()},sliderSnap:function(){this.cx=(((this.value-this.min)/this.step)*20)-4;this.slider.style.left=this.cx+'px'},sliderOnChange:function(value,snapSlider){this.value=this.options.value=value;if(snapSlider)this.sliderSnap();if(this.onchange)this.onchange(this.value)}})
